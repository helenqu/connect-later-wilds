
source env_setup.sh

SEED=0

LOGDIR=$1
mkdir -p ${LOGDIR}

LP_LRs=(0.004094210574219827 0.0019739007152135553 0.001732535496371176 0.0012055706307153415 0.0029256435350242336 0.006222466404167087 0.003778103312903904 0.002845356208163103 0.003675237433790711 0.0041249214944571195 0.0021028772639018925 0.00829293692608677 0.008921526399139361 0.0026120355558533286 0.0011300291600066298 0.0034987177258528723 0.004819623636269802 0.002762283042100979 0.001405436988127802 0.004837912261560764)
FT_LRs=(3.215209401079871e-05 2.802133817452133e-05 0.00010303115672820608 0.0010204711113805515 2.265182790039832e-05 0.003324366874654924 0.002762490232336215 2.0700377045086256e-05 6.647860328465126e-05 0.00028517332708130285 0.00015908771708877985 0.002763968783436637 0.002628894464031735 9.047328881976328e-05 2.4203738042717227e-05 3.434609999282065e-05 0.0002552852083928696 0.0006104869030303204 0.005253386828845757 3.406841995207059e-05)
TRANSFORM_Ps=(0.6744236077484681 0.5089913298176647 0.8962849858523515 0.7484971677602787 0.5295830256572817 0.8260829829811762 0.6685271509596875 0.8268880246219965 0.8993894974758598 0.6620108143573227 0.6275865614642817 0.5136308366082407 0.6925112168812042 0.5065771270417679 0.5133532637829019 0.5717379135464133 0.8072991723613716 0.6846626475068515 0.6991699344399531 0.8458741948187047)
AUG_STRENGTHs=(0.08846312362615615 0.0710112246132279 0.06188632269500114 0.06371267651032593 0.0950387089580342 0.09954774256652052 0.05137239799065769 0.08488638672978163 0.0569021026527968 0.08639245482507618 0.09736109146962708 0.09716864345724825 0.09833796130482868 0.05190909628417369 0.06132105461997675 0.057480660786796534 0.08344070292835434 0.09816334364872266 0.07962492335961684 0.07410443884068409)

SUFFIX=""
PRETRAIN_PATH=pretrained_camelyon.pth

for i in 1;
do
    LP_LR=${LP_LRs[i]}
    FT_LR=${FT_LRs[i]}
    TRANSFORM_P=${TRANSFORM_Ps[i]}
    AUG_STRENGTH=${AUG_STRENGTHs[i]}
    sbatch ${cluster_info} N 1 -c 32 --gpus=1 -t 12:00:00 --output=${LOGDIR}/camelyon_pretrain${SUFFIX}_aug_LPFT_${SEED}_lplr${LP_LR}_ftlr${FT_LR}_p${TRANSFORM_P}_augstrength${AUG_STRENGTH}.log run_camelyon.sh ${SEED} ${LP_LR} ${FT_LR} ${TRANSFORM_P} ${AUG_STRENGTH} ${PRETRAIN_PATH}
    echo "run_camelyon.sh ${SEED} ${LP_LR} ${FT_LR} ${TRANSFORM_P} ${AUG_STRENGTH} ${PRETRAIN_PATH}"
done
